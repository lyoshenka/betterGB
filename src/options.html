<html>
<head>
  <title>BetterGB Options</title>
  <script src="jquery.min.js"></script>
</head>
<body>
<script type="text/javascript">

$(document).ready(function() {
  var form = $(this).find('form'),
      options = chrome.extension.getBackgroundPage().options;

  /* load saved options into form*/
  $.each(options,function(option,defaultValue) {
    var value = localStorage.getItem(option) === null ? defaultValue : localStorage[option];
    input = $('#'+option);
    if (!input)
    {
      console.log('Did not find input ' + option);
    }
    if (input.attr('type') == 'checkbox')
    {
      console.log('Option is a checkox');
      input.attr('checked', value == 'true');
    }
    else
    {
      console.log('Not a checkbox');
      input.val(value);
    }
  });


  /* save options */
  $('#submit').click(function(e) {
    e.preventDefault();

    $.each(options, function(option,defaultValue) {
      input = $('#'+option);
      if (input.attr('type') == 'checkbox')
      {
        localStorage[option] = input.attr('checked') == 'checked';
      }
      else
      {
        localStorage[option] = input.val();
      }
    });

    $('#saved').show().fadeOut(850);
  });
});

</script>

<h1>BetterGB Options</h1>

<form>

<input type="checkbox" id="close_on_esc" /><label for='close_on_esc'>Esc closes popup</label><br />
<input type="checkbox" id="hide_cancel_button" /><label for='hide_cancel_button'>Hide Cancel button</label><br />
<br />
<input type="submit" id="submit" value="Save" />
<span id="saved" style="color:green; display:none" >Saved!</span>
</form>

</body>
</html>
